!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=10)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vec2=e.Rect=e.Point=e.Mat2d=e.LineSegment=e.Ellipse=e.ColorF=e.Color=void 0,e.Color=n(4),e.ColorF=n(6),e.Ellipse=n(7),e.LineSegment=n(8),e.Mat2d=n(9),e.Point=n(3),e.Rect=n(2),e.Vec2=n(1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.equals=e.miter=e.boundY=e.boundX=e.bound=e.fromPointToPoint=e.rotate270=e.rotate180=e.rotate90=e.normalize=e.cross=e.dot=e.length2=e.length=e.divide=e.multiply=e.subtract=e.add=e.copy=void 0;var i=n(2);function o(t,e,n){return void 0===n&&(n={}),n.x=t.x+e.x,n.y=t.y+e.y,n}function r(t,e,n){var i=t.x,o=t.y;return void 0===n&&(n={}),n.x=i*e,n.y=o*e,n}function s(t,e,n){var i=t.x,o=t.y;return void 0===n&&(n={}),n.x=i/e,n.y=o/e,n}function c(t){return Math.sqrt(a(t))}function a(t){var e=t.x,n=t.y;return e*e+n*n}function u(t,e){return t.x*e.x+t.y*e.y}function h(t,e){return void 0===e&&(e={}),s(t,c(t),e)}function l(t,e){var n=t.x,i=t.y;return void 0===e&&(e={}),e.x=i,e.y=-n,e}function d(t,e,n){var o=t+e,r=t<0?n.left:n.right;return i.containsX(n,o)?t:r-e}function f(t,e,n){var o=t+e,r=t<0?n.bottom:n.top;return i.containsX(n,o)?t:r-e}e.copy=function(t,e){return void 0===e&&(e={}),e.x=t.x,e.y=t.y,e},e.add=o,e.subtract=function(t,e,n){return void 0===n&&(n={}),n.x=t.x-e.x,n.y=t.y-e.y,n},e.multiply=r,e.divide=s,e.length=c,e.length2=a,e.dot=u,e.cross=function(t,e){return t.x*e.y-e.x*t.y},e.normalize=h,e.rotate90=l,e.rotate180=function(t,e){var n=t.x,i=t.y;return void 0===e&&(e={}),e.x=-n,e.y=-i,e},e.rotate270=function(t,e){var n=t.x,i=t.y;return void 0===e&&(e={}),e.x=-i,e.y=n,e},e.fromPointToPoint=function(t,e,n){return void 0===n&&(n={}),n.x=e.x-t.x,n.y=e.y-t.y,n},e.bound=function(t,e,n,i){return void 0===i&&(i={}),i.x=d(t.x,e.x,n),i.y=f(t.y,e.y,n),i},e.boundX=d,e.boundY=f,e.miter=function(t,e,n,i,s){void 0===s&&(s={});var c=h(l(t)),a=h(l(e)),d=h(o(c,a));return r(d,Math.min(i,n/u(d,a)),s)},e.equals=function(t,e,n){return void 0===n&&(n=0),Math.abs(t.x-e.x)<=n&&Math.abs(t.y-e.y)<=n}},function(t,e,n){"use strict";function i(t){return t.right-t.left}function o(t){return t.top-t.bottom}function r(t){return.5*(t.left+t.right)}function s(t){return.5*(t.bottom+t.top)}function c(t,e,n){var i=e.x,o=e.y;return void 0===n&&(n={}),n.left=t.left+i,n.top=t.top+o,n.right=t.right+i,n.bottom=t.bottom+o,n}function a(t,e){return t.left<=e&&e<=t.right}function u(t,e){return t.bottom<=e&&e<=t.top}Object.defineProperty(e,"__esModule",{value:!0}),e.equals=e.sort=e.containsY=e.containsX=e.containsPoint=e.contains=e.offsetY=e.offsetX=e.offset=e.inset=e.intersect=e.intersects=e.unionPoint=e.union=e.isValid=e.isEmpty=e.topRight=e.bottomRight=e.bottomLeft=e.topLeft=e.centerY=e.centerX=e.center=e.area=e.height=e.width=e.dimensions=e.empty=e.copy=void 0,e.copy=function(t,e){return void 0===e&&(e={}),e.left=t.left,e.top=t.top,e.right=t.right,e.bottom=t.bottom,e},e.empty=function(t){return void 0===t&&(t={}),t.left=0,t.top=0,t.right=0,t.bottom=0,t},e.dimensions=function(t,e,n,i,o){return void 0===o&&(o={}),o.left=t,o.top=e,o.right=t+n,o.bottom=e-i,o},e.width=i,e.height=o,e.area=function(t){return i(t)*o(t)},e.center=function(t,e){return void 0===e&&(e={}),e.x=r(t),e.y=s(t),e},e.centerX=r,e.centerY=s,e.topLeft=function(t,e){return void 0===e&&(e={}),e.x=t.left,e.y=t.top,e},e.bottomLeft=function(t,e){return void 0===e&&(e={}),e.x=t.left,e.y=t.bottom,e},e.bottomRight=function(t,e){return void 0===e&&(e={}),e.x=t.right,e.y=t.bottom,e},e.topRight=function(t,e){return void 0===e&&(e={}),e.x=t.right,e.y=t.top,e},e.isEmpty=function(t){return t.left>=t.right||t.bottom>=t.top},e.isValid=function(t){return t.right>=t.left&&t.top>=t.bottom},e.union=function(t,e,n){return void 0===n&&(n={}),n.left=Math.min(t.left,e.left),n.right=Math.max(t.right,e.right),n.bottom=Math.min(t.bottom,e.bottom),n.top=Math.max(t.top,e.top),n},e.unionPoint=function(t,e,n){var i=e.x,o=e.y;return void 0===n&&(n={}),n.left=Math.min(i,t.left),n.top=Math.max(o,t.top),n.right=Math.max(i,t.right),n.bottom=Math.min(o,t.bottom),n},e.intersects=function(t,e){return t.right>=e.left&&e.right>=t.left&&t.top>=e.bottom&&e.top>=t.bottom},e.intersect=function(t,e,n){return void 0===n&&(n={}),n.left=Math.max(t.left,e.left),n.right=Math.min(t.right,e.right),n.bottom=Math.max(t.bottom,e.bottom),n.top=Math.min(t.top,e.top),n},e.inset=function(t,e,n){var i=e.x,o=e.y;return void 0===n&&(n={}),n.left=t.left+i,n.top=t.top-o,n.right=t.right-i,n.bottom=t.bottom+o,n},e.offset=c,e.offsetX=function(t,e,n){return void 0===n&&(n={}),c(t,{x:e,y:0},n)},e.offsetY=function(t,e,n){return void 0===n&&(n={}),c(t,{x:0,y:e},n)},e.contains=function(t,e){return t.left<=e.left&&e.right<=t.right&&t.bottom<=e.bottom&&e.top<=t.top},e.containsPoint=function(t,e){var n=e.x,i=e.y;return a(t,n)&&u(t,i)},e.containsX=a,e.containsY=u,e.sort=function(t,e){var n=t.top,i=t.left,o=t.bottom,r=t.right;void 0===e&&(e={});var s=o>n,c=i>r;return e.top=s?o:n,e.left=c?r:i,e.bottom=s?n:o,e.right=c?i:r,e},e.equals=function(t,e,n){return void 0===n&&(n=0),Math.abs(t.left-e.left)<=n&&Math.abs(t.top-e.top)<=n&&Math.abs(t.right-e.right)<=n&&Math.abs(t.bottom-e.bottom)<=n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.equals=e.distance2=e.distance=e.midpoint=e.copy=void 0;var i=n(1);function o(t,e){return i.length2(i.fromPointToPoint(t,e))}e.copy=function(t,e){return void 0===e&&(e={}),e.x=t.x,e.y=t.y,e},e.midpoint=function(t,e,n){return void 0===n&&(n={}),i.multiply(i.add(t,e,n),.5,n)},e.distance=function(t,e){return Math.sqrt(o(t,e))},e.distance2=o,e.equals=function(t,e,n){return void 0===n&&(n=0),Math.abs(t.x-e.x)<=n&&Math.abs(t.y-e.y)<=n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.equals=e.isTransparent=e.isOpaque=e.blend=e.random=e.toArgbString=e.fromArgbString=e.toRgbaInt=e.fromRgbInt=e.fromRgbaInt=e.copy=void 0;var i=n(5);function o(t,e){return void 0===e&&(e={}),e.r=t>>24&255,e.g=t>>16&255,e.b=t>>8&255,e.a=t>>0&255,e}e.copy=function(t,e){return void 0===e&&(e={}),e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a,e},e.fromRgbaInt=o,e.fromRgbInt=function(t,e){return void 0===e&&(e={}),o(t<<8|255,e)},e.toRgbaInt=function(t){return(t.r<<24|t.g<<16|t.b<<8|t.a<<0)>>>0},e.fromArgbString=function(t,e){void 0===e&&(e={});var n="#"==t[0]?1:0;return e.a=parseInt(t.substr(n,2),16),e.r=parseInt(t.substr(n+2,2),16),e.g=parseInt(t.substr(n+4,2),16),e.b=parseInt(t.substr(n+6,2),16),e},e.toArgbString=function(t){return"#"+i.pad(t.a.toString(16))+i.pad(t.r.toString(16))+i.pad(t.g.toString(16))+i.pad(t.b.toString(16))},e.random=function(t){return void 0===t&&(t={}),t.r=i.randomByte(),t.g=i.randomByte(),t.b=i.randomByte(),t.a=void 0===t.a?255:t.a,t},e.blend=function(t,e,n){void 0===n&&(n={});var i=t.a+1,o=256-t.a;return n.r=i*t.r+o*e.r>>8,n.g=i*t.g+o*e.g>>8,n.b=i*t.b+o*e.b>>8,n.a=e.a,n},e.isOpaque=function(t){return 255===t.a},e.isTransparent=function(t){return 0===t.a},e.equals=function(t,e){return t.r==e.r&&t.g==e.g&&t.b==e.b&&t.a==e.a}},function(t,e,n){"use strict";function i(t,e){return Math.floor(Math.random()*(e-t+1))+t}Object.defineProperty(e,"__esModule",{value:!0}),e.randomByte=e.randomInt=e.pad=void 0,e.pad=function(t){return 1==t.length?"0"+t:t},e.randomInt=i,e.randomByte=function(){return i(0,255)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.premultiplyAlpha=e.isOpaque=e.random=e.toColor=e.fromColor=e.equals=e.isTransparent=e.copy=void 0;var i=n(4);Object.defineProperty(e,"copy",{enumerable:!0,get:function(){return i.copy}}),Object.defineProperty(e,"isTransparent",{enumerable:!0,get:function(){return i.isTransparent}}),e.equals=function(t,e,n){return void 0===n&&(n=0),Math.abs(t.r-e.r)<=n&&Math.abs(t.g-e.g)<=n&&Math.abs(t.b-e.b)<=n},e.fromColor=function(t,e){return void 0===e&&(e={}),e.r=t.r/255,e.g=t.g/255,e.b=t.b/255,e.a=t.a/255,e},e.toColor=function(t,e){return void 0===e&&(e={}),e.r=255*t.r>>0,e.g=255*t.g>>0,e.b=255*t.b>>0,e.a=255*t.a>>0,e},e.random=function(t){return void 0===t&&(t={}),t.r=Math.random(),t.g=Math.random(),t.b=Math.random(),t.a=void 0===t.a?1:t.a,t},e.isOpaque=function(t){return 1===t.a},e.premultiplyAlpha=function(t,e){return void 0===e&&(e={}),e.r=t.r*t.a,e.g=t.g*t.a,e.b=t.b*t.a,e.a=1,e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.equals=e.containsPoint=e.fromRect=e.circle=e.copy=void 0;var i=n(3),o=n(2),r=n(1);function s(t,e){return void 0===e&&(e={}),e.rx=t.rx,e.ry=t.ry,e.c=i.copy(t.c,e.c),e}e.copy=s,e.circle=function(t,e,n){return void 0===n&&(n={}),s({rx:t,ry:t,c:e},n)},e.fromRect=function(t,e){return void 0===e&&(e={}),s({rx:o.width(t)/2,ry:o.height(t)/2,c:o.center(t)},e)},e.containsPoint=function(t,e){var n=r.fromPointToPoint(e,t.c),i=n.x/t.rx,o=n.y/t.ry;return i*i+o*o<=1},e.equals=function(t,e,n){return void 0===n&&(n=0),Math.abs(t.rx-e.rx)<=n&&Math.abs(t.ry-e.ry)<=n&&i.equals(t.c,e.c,n)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.equals=e.containsPoint=e.copy=void 0;var i=n(3),o=n(1);e.copy=function(t,e){return void 0===e&&(e={}),e.p1=i.copy(t.p1,e.p1),e.p2=i.copy(t.p2,e.p2),e},e.containsPoint=function(t,e,n){void 0===n&&(n=0);var r=t.p1,s=o.fromPointToPoint(t.p1,t.p2),c=-1,a=o.fromPointToPoint(r,e),u=o.length2(s);if(0!=u&&(c=o.dot(s,a)/u),c<0||c>1)return!1;var h=o.add(r,o.multiply(s,c));return i.distance2(h,e)<=n*n},e.equals=function(t,e,n){return void 0===n&&(n=0),i.equals(t.p1,e.p1,n)&&i.equals(t.p2,e.p2,n)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.equals=e.mapRect=e.mapPoint=e.rectToRect=e.sinCos=e.stretchRotateToPoint=e.rotate=e.stretch=e.scaleToPoint=e.scale=e.translate=e.identity=e.conjugate=e.pivot=e.concat=e.determinant=e.invert=e.copy=void 0;var i=n(1),o=n(2);function r(t,e){void 0===e&&(e={});var n=s(t),i=t.c1r1,o=t.c2r1,r=t.c3r1,c=t.c1r2,a=t.c2r2,u=t.c3r2;return e.c1r1=a/n,e.c2r1=-o/n,e.c3r1=(o*u-r*a)/n,e.c1r2=-c/n,e.c2r2=i/n,e.c3r2=(c*r-i*u)/n,e}function s(t){return t.c1r1*t.c2r2-t.c2r1*t.c1r2}function c(t,e,n){void 0===n&&(n={});var i=t.c1r1*e.c1r1+t.c2r1*e.c1r2,o=t.c1r1*e.c2r1+t.c2r1*e.c2r2,r=t.c1r1*e.c3r1+t.c2r1*e.c3r2+t.c3r1,s=t.c1r2*e.c1r1+t.c2r2*e.c1r2,c=t.c1r2*e.c2r1+t.c2r2*e.c2r2,a=t.c1r2*e.c3r1+t.c2r2*e.c3r2+t.c3r2;return n.c1r1=i,n.c2r1=o,n.c3r1=r,n.c1r2=s,n.c2r2=c,n.c3r2=a,n}function a(t,e,n){return void 0===n&&(n={}),u(t,h(e),n)}function u(t,e,n){return void 0===n&&(n={}),c(e,c(t,r(e)),n)}function h(t,e){var n=t.x,i=t.y;return void 0===e&&(e={}),e.c1r1=1,e.c2r1=0,e.c3r1=n,e.c1r2=0,e.c2r2=1,e.c3r2=i,e}function l(t,e){var n=t.x,i=t.y;return void 0===e&&(e={}),e.c1r1=n,e.c2r1=0,e.c3r1=0,e.c1r2=0,e.c2r2=i,e.c3r2=0,e}function d(t,e){return void 0===e&&(e={}),l({x:t,y:t},e)}function f(t,e,n){return void 0===n&&(n={}),n.c1r1=e,n.c2r1=-t,n.c3r1=0,n.c1r2=t,n.c2r2=e,n.c3r2=0,n}function g(t,e){switch(e){case 0:return o.center(t);case 1:return{x:t.right,y:t.bottom};default:return{x:t.left,y:t.top}}}function v(t,e,n){var i=e.x,o=e.y;return void 0===n&&(n={}),n.x=t.c1r1*i+t.c2r1*o+t.c3r1,n.y=t.c1r2*i+t.c2r2*o+t.c3r2,n}e.copy=function(t,e){return void 0===e&&(e={}),e.c1r1=t.c1r1,e.c2r1=t.c2r1,e.c3r1=t.c3r1,e.c1r2=t.c1r2,e.c2r2=t.c2r2,e.c3r2=t.c3r2,e},e.invert=r,e.determinant=s,e.concat=c,e.pivot=a,e.conjugate=u,e.identity=function(t){return void 0===t&&(t={}),t.c1r1=1,t.c2r1=0,t.c3r1=0,t.c1r2=0,t.c2r2=1,t.c3r2=0,t},e.translate=h,e.scale=l,e.scaleToPoint=function(t,e,n,o){void 0===o&&(o={});var r=i.fromPointToPoint(n,t),s=i.fromPointToPoint(n,e);return a(l({x:s.x/r.x,y:s.y/r.y},o),n,o)},e.stretch=d,e.rotate=function(t,e){return void 0===e&&(e={}),f(Math.sin(t),Math.cos(t),e)},e.stretchRotateToPoint=function(t,e,n,o){void 0===o&&(o={});var r=i.fromPointToPoint(n,t),s=i.fromPointToPoint(n,e),u=i.length(r),h=i.length(s),l=d(h/u),g=i.divide(r,u),v=i.divide(s,h);return a(c(l,f(i.cross(g,v),i.dot(g,v))),n,o)},e.sinCos=f,e.rectToRect=function(t,e,n,r){void 0===n&&(n=2),void 0===r&&(r={});var s={x:0,y:0},a=g(t,n),u=g(e,n);h(i.fromPointToPoint(a,s),r);var f=o.width(e)/o.width(t),v=o.height(e)/o.height(t);return c(2==n?l({x:f,y:v}):d(Math.min(f,v)),r,r),c(h(i.fromPointToPoint(s,u)),r,r)},e.mapPoint=v,e.mapRect=function(t,e,n){void 0===n&&(n={});var i=v(t,o.topLeft(e)),r=i.x,s=i.y;o.dimensions(r,s,0,0,n);for(var c=0,a=[o.bottomLeft(e),o.bottomRight(e),o.topRight(e)];c<a.length;c++){var u=a[c];o.unionPoint(n,v(t,u),n)}return n},e.equals=function(t,e,n){return void 0===n&&(n=0),Math.abs(t.c1r1-e.c1r1)<=n&&Math.abs(t.c1r2-e.c1r2)<=n&&Math.abs(t.c2r1-e.c2r1)<=n&&Math.abs(t.c2r2-e.c2r2)<=n&&Math.abs(t.c3r1-e.c3r1)<=n&&Math.abs(t.c3r2-e.c3r2)<=n}},function(t,e,n){"use strict";n.r(e);var i,o=n(0);class r{constructor(t,e,n){this.center=t,this.radius=e,this.velocity=n,this.target=o.Rect.dimensions(this.center.x+this.velocity.x-this.radius,this.center.y+this.velocity.y+this.radius,2*this.radius,2*this.radius)}onGameTick(t){this.show(t),this.move()}show({ctx:t}){t.beginPath(),t.arc(this.center.x,this.center.y,this.radius,0,2*Math.PI),t.fillStyle="#0095DD",t.fill(),t.closePath()}move(){o.Vec2.add(this.velocity,this.center,this.center),o.Rect.offset(this.target,this.velocity,this.target),console.log(this.velocity,this.center)}collidesWithWall({bounds:t}){return!o.Rect.containsX(t,this.target.left)||!o.Rect.containsX(t,this.target.right)}collidesWithCeiling({bounds:t}){return!o.Rect.containsY(t,this.target.bottom)}collidesWithFloor({bounds:t}){return!o.Rect.containsY(t,this.target.top)}collidesWithPaddle({bounds:t}){return o.Rect.intersects(t,this.target)}collidesWithBrick(t){return t.isIntact&&o.Rect.intersects(t.bounds,this.target)}bounceAgainstWall(t){this.velocity.x=-this.velocity.x}bounceAgainstCeiling(t){this.velocity.y=-this.velocity.y}bounceAgainstPaddle(t){this.velocity.y=-this.velocity.y}bounceAgainstBrick(t){this.velocity.y=-this.velocity.y}}class s{handleCollision(t){return this.handleCollisionWithBricks(t)||this.handleCollisionWithPaddle(t)||this.handleCollisionWithWall(t)||this.handleCollisionWithCeiling(t)||this.handleCollisionWithFloor(t)}handleCollisionWithBricks(t){return t.bricks.some(e=>this.handleCollisionWithBrick(t,e))}handleCollisionWithBrick(t,e){let{ball:n,bricks:i,score:o}=t;if(n.collidesWithBrick(e))return n.bounceAgainstBrick(e),e.destroy(),++o.value==i.length&&t.complete(),!0}handleCollisionWithPaddle({ball:t,paddle:e}){if(t.collidesWithPaddle(e))return t.bounceAgainstPaddle(e),!0}handleCollisionWithWall({ball:t,room:e}){if(t.collidesWithWall(e))return console.log("wall collision",t,e.bounds),t.bounceAgainstWall(e),!0}handleCollisionWithCeiling({ball:t,room:e}){if(t.collidesWithCeiling(e))return t.bounceAgainstCeiling(e),!0}handleCollisionWithFloor(t){let{ball:e,room:n}=t;if(e.collidesWithFloor(n))return t.stop(),!0}}!function(t){t[t.INTACT=0]="INTACT",t[t.DESTROYED=1]="DESTROYED"}(i||(i={}));class c{constructor(t){this.bounds=t,this.status=i.INTACT}get isIntact(){return this.status==i.INTACT}destroy(){this.status=i.DESTROYED}onGameTick(t){this.status==i.INTACT&&this.show(t)}show({ctx:t}){t.beginPath(),t.rect(this.bounds.left,this.bounds.bottom,o.Rect.width(this.bounds),o.Rect.height(this.bounds)),t.fillStyle="#0095DD",t.fill(),t.closePath()}}class a{newBricks(t,e,n){return Array.from(this.newBrickGenerator(t,e,n))}*newBrickGenerator(t,e,n){for(let i=0;i<t;i++)for(let t=0;t<e;t++)yield this.newBrick(i,t,n)}newBrick(t,e,{padding:n,width:i,height:o,offsetLeft:r,offsetTop:s}){let a=t*(i+n)+r,u=e*(o+n)+s;return new c({left:a,top:u+o,right:a+i,bottom:u})}}class u{constructor(t){this.canvasEl=t,this.dragging=!1,this.dragPosition={},this.onPointerDown=t=>{this.dragging=t.target==this.canvasEl},this.onPointerMove=t=>{this.dragging&&(t.preventDefault(),this.dragPosition.x=t.clientX-this.canvasEl.offsetLeft,this.dragPosition.y=t.clientY-this.canvasEl.offsetTop)},this.onPointerUp=t=>{this.dragging=!1}}getDragPosition(){return this.dragging?this.dragPosition:null}startListening(){this.canvasEl.addEventListener("pointerdown",this.onPointerDown),this.canvasEl.addEventListener("pointermove",this.onPointerMove),this.canvasEl.addEventListener("pointerup",this.onPointerUp),this.canvasEl.addEventListener("pointercancel",this.onPointerUp)}stopListening(){this.canvasEl.removeEventListener("pointerdown",this.onPointerDown),this.canvasEl.removeEventListener("pointermove",this.onPointerMove),this.canvasEl.removeEventListener("pointerup",this.onPointerUp),this.canvasEl.removeEventListener("pointercancel",this.onPointerUp)}}class h{constructor(t,e,n,i,o,r,s,c,a){this.ctx=t,this.dragDetector=e,this.keyListener=n,this.ballCollisionHandler=i,this.room=o,this.score=r,this.bricks=s,this.ball=c,this.paddle=a,this.tick=0,this.running=!1,this.onFrameRequest=()=>{this.tick++,this.ballCollisionHandler.handleCollision(this),this.room.onGameTick(this),this.score.onGameTick(this),this.bricks.forEach(t=>t.onGameTick(this)),this.ball.onGameTick(this),this.paddle.onGameTick(this),this.requestNextFrame()}}start(){this.running=!0,this.dragDetector.startListening(),this.keyListener.startListening(),this.requestNextFrame()}stop(){this.running=!1,this.dragDetector.stopListening(),this.keyListener.stopListening(),alert("GAME OVER"),document.location.reload()}complete(){this.running=!1,this.dragDetector.stopListening(),this.keyListener.stopListening(),alert("YOU WIN, CONGRATULATIONS!"),document.location.reload()}requestNextFrame(){this.running&&requestAnimationFrame(this.onFrameRequest)}}class l{constructor(){this.leftKeyPressed=!1,this.rightKeyPressed=!1,this.onKeyDown=t=>{switch(t.key){case"Left":case"ArrowLeft":this.leftKeyPressed=!0;break;case"Right":case"ArrowRight":this.rightKeyPressed=!0}},this.onKeyUp=t=>{switch(t.key){case"Left":case"ArrowLeft":this.leftKeyPressed=!1;break;case"Right":case"ArrowRight":this.rightKeyPressed=!1}}}startListening(){document.addEventListener("keydown",this.onKeyDown,!1),document.addEventListener("keyup",this.onKeyUp,!1)}stopListening(){document.removeEventListener("keydown",this.onKeyDown,!1),document.removeEventListener("keyup",this.onKeyUp,!1)}}class d{constructor(t,e){this.bounds=t,this.speed=e}onGameTick(t){this.show(t),this.handleLeftKeyPress(t),this.handleRightKeyPress(t),this.handleDragging(t)}show({ctx:t}){t.beginPath(),t.rect(this.bounds.left,this.bounds.bottom,o.Rect.width(this.bounds),o.Rect.height(this.bounds)),t.fillStyle="#0095DD",t.fill(),t.closePath()}handleLeftKeyPress({room:t,keyListener:e}){e.leftKeyPressed&&this.move(o.Vec2.boundX(-this.speed,this.bounds.left,t.bounds))}handleRightKeyPress({room:t,keyListener:e}){e.rightKeyPressed&&this.move(o.Vec2.boundX(this.speed,this.bounds.right,t.bounds))}move(t){o.Rect.offsetX(this.bounds,t,this.bounds)}handleDragging({room:t,dragDetector:e}){let n=e.getDragPosition();n&&o.Rect.containsX(t.bounds,n.x)&&o.Rect.offsetX(this.bounds,n.x-o.Rect.centerX(this.bounds),this.bounds)}}class f{constructor(t){this.bounds=t}get width(){return o.Rect.width(this.bounds)}get height(){return o.Rect.height(this.bounds)}onGameTick({ctx:t}){t.clearRect(this.bounds.bottom,this.bounds.left,this.width,this.height)}}class g{constructor(t,e){this.x=t,this.y=e,this.value=0}onGameTick({ctx:t}){t.font="16px Arial",t.fillStyle="#0095DD",t.fillText("Score: "+this.value,this.x,this.y)}}let v=document.querySelector("#gameboard");new class{constructor(t){this.canvasEl=t}newGame(){let t=this.newRoom(),e=this.newBricks(),n=this.newBall(t),i=this.newPaddle(t),o=this.canvasEl.getContext("2d"),r=new u(this.canvasEl);return new h(o,r,new l,new s,t,this.newScore(),e,n,i)}newRoom(){let{width:t,height:e}=this.canvasEl;return new f({left:0,top:e,right:t,bottom:0})}newScore(){return new g(8,20)}newBall(t){return new r({x:t.width/2,y:t.height-30},10,{x:2,y:-2})}newPaddle(t){let e=(t.width-75)/2,n=t.height,i=o.Rect.dimensions(e,n,75,10);return new d(i,7)}newBricks(){return(new a).newBricks(3,5,{width:75,height:20,padding:10,offsetTop:30,offsetLeft:30})}}(v).newGame().start()}]);
//# sourceMappingURL=index.js.map